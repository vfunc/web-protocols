# HTTP/2 特性概述

## HTTP/1.1 发展中遇到的问题

### HTTP/1.1 发明以来发生了哪些变化？

* 从几 KB 大小的消息，到几 MB 大小的消息
* 每个页面小于 10 个资源，到每页面 100 多个资源
* 从文本为主的内容，到富媒体（如图片、声音、视频）为主的内容
* 对页面内容实时性高要求的应用越来越多

### HTTP/1.1 的高延迟问题

* 高延迟带来页面加载速度的降低
* 随着带宽的增加，延迟并没有显著下降
* 并发连接有限
* 同一连接同时只能在完成一个 HTTP 事务（请求/响应）才能处理下一个事务

### 高延迟 VS 高带宽

* 单连接上的串行请求
* 无状态导致的高传输量（低网络效率）

### 无状态特性带来的巨大 HTTP 头部

* 重复传输的体积巨大的 HTTP 头部

### HTTP/1.1 为了解决性能问题做过的努力

* Spriting 合并多张小图为一张大图供浏览器 JS 切割使用
  - 不能区别对待
* Inlining 内联，将图片嵌入到 CSS 或者 HTML 文件中，减少网络请求次数
* Concatenation 拼接，将多个体积较小的 JavaScript 使用 webpack 等工具打包成 1 个体积更大的 JavaScript 文件
  - 1 个文件的改动导致用户重新下载多个文件
* Sharding 分片，将同一页面的资源分散到不同域名下，提升连接上限

### HTTP/1.1 不支持服务器推送消息

## HTTP/2 有哪些特性？

* HTTP2（RFC7540，2015.5）
  - 在应用层上修改，基于并充分挖掘 TCP 协议性能
  - 客户端向 server 发送 request 这种基本模型不会变。
  - 老的 scheme 不会变，没有 http2://。
  - 使用 http/1.x 的客户端和服务器可以无缝的通过代理方式 转接到 http/2 上。
  - 不识别 http/2 的代理服务器可以将请求降级到 http/1.x

### 主流浏览器对 HTTP/2 的支持程度

* <https://caniuse.com/http2>
* <https://http2.akamai.com/demo>

### HTTP/2 主要特性

* 传输数据量的大幅减少
  - 以二进制方式传输
  - 标头压缩
* 多路复用及相关功能
  - 消息优先级
* 服务器消息推送
  - 并行推送

> 此文章为 2 月 Day7 学习笔记，内容来源于极客时间[《Web 协议详解与抓包实战》](http://gk.link/a/11UWp)，强烈推荐该课程！
