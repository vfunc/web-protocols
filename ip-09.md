# 多播与 IGMP 协议

### 广播与组播

* 单播
* 广播
* 组播

### 广播地址 

* 以太网地址：ff:ff:ff:ff:ff:ff
* IP 地址

| 网络号 | 主机号 | A 类示例           | B 类示例           | C 类示例           | 含义                |
|-----|-----|-----------------|-----------------|-----------------|-------------------|
| 网络号 | 主机号 | 77.91.215.5     | 154.3.99.6      | 227.82.157.160  | 指定某个主机            |
| 网络号 | 全 0 | 77.0.0.0        | 154.3.0.0       | 227.82.157.0    | 指定某个网络            |
| 全 0 | 主机号 | 0.91.215.5      | 0.0.99.6        | 0.0.0.160       | 指定当前所属网络下的某个主机    |
| 全 0 | 全 0 | 0.0.0.0         | 0.0.0.0         | 0.0.0.0         | 指定自己的默认 IP 地址     |
| 网络号 | 全 1 | 77.255.255.255  | 154.3.255.255   | 227.82.157.255  | 指定某个网络下的所有主机，用于广播 |
| 全 1 | 全 1 | 255.255.255.255 | 255.255.255.255 | 255.255.255.255 | 所有主机              |

### 组播IP地址

| IP 地址类别 | 首字节       | 网络号 Bit 数 | 主机号 Bit 数 | 理论地址范围                     | 预期用途               |
|---------|-----------|-----------|-----------|----------------------------|--------------------|
| A 类地址   | 0xxx xxxx | 8         | 24        | 1.0.0.0-126.255.255.255    | 特大网络的单播传输          |
| B 类地址   | 10xx xxxx | 16        | 16        | 128.0.0.0-191.255.255.255  | 数千台中大型网络的单播传输      |
| C 类地址   | 110x xxxx | 24        | 8         | 192.0.0.0-223.255.255.255  | 250 台主机以下小型网络的单播传输 |
| D 类地址   | 1110 xxxx | n/a       | n/a       | 224.0.0.0-239.255.255.255  | IP 组播              |
| E 类地址   | 1111 xxxx | n/a       | n/a       | 240.0.0.0- 255.255.255.255 | 预留实验用              |

* 预留组播地址
  - 224.0.0.1：子网内的所有系统组
  - 224.0.0.2：子网内的所有路由器组
  - 224.0.1.1：用于 NTP 同步系统时钟
  - 224.0.0.9：用于 RIP-2 协议

### 组播以太网地址

* 以太网地址：01:00:5e:00:00:00 到 01:00:5e:7f:ff:ff
* 低 23 位：映射 IP 组播地址至以太网地址
  - 224.0.0.22: 11100000 00000000 00000000 00010110
  - 01:00:5e:00:00:16: 0000001 00000000 01011110 00000000 00000000 00010110

### IGMP（Internet Group Management Protocol）协议

* Type 类型
  - 0x11 Membership Query [RFC3376]
  - 0x22 Version 3 Membership Report [RFC3376]
  - 0x12 Version 1 Membership Report [RFC-1112]
  - 0x16 Version 2 Membership Report [RFC-2236]
  - 0x17 Version 2 Leave Group [RFC-2236]

### Group Record 格式

* Record Type 类型
  - 当前状态
    - 1: MODE_IS_INCLUDE
    - 2: MODE_IS_EXCLUDE
  - 过滤模式变更（如从 INCLUDE 奕为 EXCLUDE）
    - 3: CHANGE_TO_INCLUDE
    - 4: CHANGE_TO_EXCLUDE
  - 源地址列表变更（过滤模式同时决定状态）
    - 5: ALLOW_NEW_SOURCES
    - 6: BLOCK_OLD_SOURCES

> 此文章为 4 月 Day13 学习笔记，内容来源于极客时间[《Web 协议详解与抓包实战》](http://gk.link/a/11UWp)，强烈推荐该课程！
