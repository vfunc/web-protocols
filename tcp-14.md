# SACK 与选择性重传算法

### 仅重传丢失段 保守乐观

* 累积确认 Sequence 序号的问题
  - Client 无法告知收到了 Part4
  - Server 发送窗口/Client 接收窗口停止

### 重传所有段 积极悲观

* 重传所有段：积极悲观
  - 可能浪费带宽
* 仅重传丢失段：保守乐观
  - 大量丢包时效率低下

### SACK：TCP Selective Acknowledgment

* RFC2018

| 类型 | 总长度（字节） | 数据             | 描述                    |
| -- | ------- | -------------- | --------------------- |
| 0  | -       | -              | 选项列表末尾标识              |
| 1  | -       | -              | 无意义，用于32位对齐使用         |
| 2  | 4       | MSS值           | 握手时发送端告知可以接收的最大报文段大小  |
| 3  | 3       | 窗口移位           | 指明最大窗口扩展后的大小          |
| 4  | 2       | -              | 表明支持SACK选择性确认中间报文段功能  |
| 5  | 可变      | 确认报文段          | 选择性确认窗□中间的Segments报文段 |
| 8  | 10      | Timestamps 时间戳 | 用于更精准的计算RTT,及解决PAWS问题 |
| 14 | 3       | 校验和算法          | 双方认可后，可使用新的校验和算法      |
| 15 | 可变      | 校验和            | 当16位标准校验和放不下时，放置在这里   |
| 34 | 可变      | FOC            | TFO 中 Cookie          |

### 引入SACK

* 选择性确认

### SACK

* Left Edge of Block
* Right Edge of Block

> 此文章为 3 月 Day30 学习笔记，内容来源于极客时间[《Web 协议详解与抓包实战》](http://gk.link/a/11UWp)，强烈推荐该课程！
